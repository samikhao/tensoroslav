# Tensoroslav Game

Интерактивная игра, основанная на **полиномиальной модели (Ridge + PolynomialFeatures)**.  
Игроку предстоит «нащупать» идеальные веса, минимизирующие предсказанное MSE модели.

---

## Идея игры

Каждая сессия создаёт собственное скрытое пространство признаков и уникальный «идеальный» вектор весов `w*` размерности `D = 10`.

Игрок вводит 10 целочисленных весов `W0–W9` (в диапазоне от -5 до 5).  
Модель вычисляет **игровое MSE**, зависящее как от предсказания модели, так и от расстояния до скрытого вектора `w*`.

Цель — минимизировать это значение, постепенно подбирая правильные веса.  
История попыток отображается на странице.

---

## Техническое устройство

### Структура проекта

```
TENSOROSLAV/
│
├── app/
│   ├── main.py           # FastAPI-приложение
│   └── templates/
│       └── index.html    # интерфейс игры (Jinja2)
│
├── model/
│   ├── main.ipynb        # ноутбук с решением исходной задачи
│   ├── ridge_poly.joblib # обученная полиномиальная модель
│   ├── train_weights.csv # тренировочные данные
│   └── test_weights.csv  # тестовые данные
│
├── requirements.txt
└── README.md
```

---

## Основные зависимости

- **fastapi** — веб-сервер
- **jinja2** — шаблонизатор для HTML-интерфейса
- **numpy**, **pandas** — работа с данными
- **joblib** — загрузка сохранённой модели
- **scikit-learn** — обучение Ridge + PolynomialFeatures (в ноутбуке)

---

## Как запустить

```bash
# Установка зависимостей
pip install -r requirements.txt

# Запуск сервера разработки
uvicorn app.main:app --reload
```

После запуска приложение будет доступно по адресу:  
[http://127.0.0.1:8000](http://127.0.0.1:8000)

---

## Папка `model/`

В папке **model/** лежит оригинальное решение ML-задачи:  
- ноутбук **`main.ipynb`** — исследование и обучение полиномиальной модели Ridge,  
- **`ridge_poly.joblib`** — сериализованный пайплайн, используемый игрой,  
- **`train_weights.csv`** и **`test_weights.csv`** — обучающая и тестовая выборки.

---

## Принцип игры

- Сервер генерирует случайные параметры (`Q`, `S`, `b`) и скрытый вектор `w*`.
- Игрок вводит 10 весов.
- Сервер вычисляет предсказание модели и возвращает значение MSE.
- История всех попыток сохраняется в текущей сессии.

---

## История и контекст

Проект вдохновлён заданием **«Предсказание ошибок»** из **LLM: Scaling Week by YSDA**.

В оригинальном задании незадачливый ML-инженер Тензорослав обучал линейную регрессию и, не зная градиентных методов, искал оптимум с помощью случайного поиска — генерируя случайные векторы весов и вычисляя для них MSE.  
В какой-то момент он случайно удалил выборку с посчитанными ошибками, и нужно было предсказать значения MSE для оставшихся весов.

**Tensoroslav Game** превращает эту историю в интерактивную мини-игру, где теперь игрок сам берёт на себя роль Тензорослава и пытается «нащупать» оптимальные веса, наблюдая изменение MSE.
