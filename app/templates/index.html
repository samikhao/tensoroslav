<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Игра “Поиграй за Тензорослава”</title>

  <style>
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      margin: 40px;
      background: #fafafa;
      color: #222;
    }
    h1 { margin-top: 0; }
    .info { margin: 0.5em 0 1em; color: #555; font-size: 0.95em; }
    a.button {
      display: inline-block; padding: 6px 10px; border: 1px solid #ccc;
      border-radius: 6px; background: #fff; text-decoration: none; color: #222;
    }
    form {
      margin-top: 1em; padding: 1em; background: #fff; border: 1px solid #ddd; border-radius: 8px;
      display: inline-block;
    }
    .weights {
      display: grid; grid-template-columns: repeat(5, 1fr);
      gap: 6px 14px; margin-bottom: 1em;
    }
    label { font-size: 0.9em; display: flex; justify-content: space-between; align-items: center; gap: 8px; }
    input[type="number"] { width: 80px; }
    button {
      padding: 8px 14px; border: 1px solid #ccc; border-radius: 8px; background: #fff; cursor: pointer;
    }
    table {
      border-collapse: collapse; margin-top: 1em; background: #fff; border: 1px solid #ddd; width: 100%; max-width: 900px;
    }
    th, td { border: 1px solid #ccc; padding: 6px 10px; text-align: left; font-size: 0.92em; }
    th { background: #f3f3f3; }
    code { background: #eee; padding: 1px 4px; border-radius: 4px; }
  </style>
</head>
<body>

  <h1>Игра “Поиграй за Тензорослава”</h1>

  <div>
    <p>
      Цель — подобрать целочисленные веса W0–W9 (от
      {{ int_min }} до {{ int_max }}), при которых предсказанное MSE минимально.
    </p>
    <p>
      <a href="/new">Новая игра</a>
      {% if sid %}Сессия: {{ sid }}{% endif %}
    </p>
  </div>

  <form action="/predict" method="post">
    <input type="hidden" name="sid" value="{{ sid }}">
    <div>
      {% for i in range(D) %}
      <label>
        W{{ i }}
        <input name="w{{ i }}" type="number" step="1" min="{{ int_min }}" max="{{ int_max }}" required>
      </label>
      {% endfor %}
    </div>
    <button>Предсказать MSE</button>
  </form>

  {% if last_mse is defined %}
    <h3>Предсказанное MSE: {{ '%.6f'|format(last_mse) }}</h3>
  {% endif %}

  <h2>История</h2>
  {% if history %}
  <table>
    <tr>
      <th>#</th>
      <th>W-вектор</th>
      <th>MSE (модель)</th>
    </tr>
    {% for row in history %}
    <tr>
      <td>{{ loop.index }}</td>
      <td>{{ row.w | join(', ') }}</td>
      <td>{{ row.mse }}</td>
    </tr>
    {% endfor %}
  </table>
  {% else %}
    <p>История пуста — введите первые веса и нажмите «Предсказать MSE».</p>
  {% endif %}

</body>
</html>
